read once and build intermediary